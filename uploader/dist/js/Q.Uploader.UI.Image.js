//devin87@qq.com
//build:2022/01/07 10:47:04
!function(r,l){"use strict";var f=Q.getFirst,p=Q.getNext,v=Q.createEle,m=Q.setOpacity,o=Q.ie,c=Q.Uploader;function i(e,t){e.className+=" "+t}function n(t,e,i){var a=e.input,e=e.file||(a.files?a.files[0]:l);if(e)!function(e,t){var i=r.URL||r.webkitURL;if(i)return t(i.createObjectURL(e));r.FileReader?((i=new FileReader).onload=function(e){t(e.target.result)},i.readAsDataURL(e)):e.readAsDataURL&&t(e.readAsDataURL())}(e,function(e){e&&(t.innerHTML='<img src="'+e+'" />'),i&&i(e)});else if(a){e=a.value;if(e&&!/^\w:\\fakepath/.test(e)||(a.select(),parent.document.body.focus(),document.selection&&(e=document.selection.createRange().text)),e){t.innerHTML='<img src="'+e+'" />';try{6<o&&(t.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='scale',src='"+e+"')")}catch(e){}}i&&i(e)}}var s=r.Blob||r.WebkitBlob||r.MozBlob,d=r.WebKitBlobBuilder||r.MozBlobBuilder,a=function(){if(!r.FileReader||!r.atob||!s&&!d)return!1;var e=document.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")}();function u(e,n,s,l){var c=new Image;c.src=e,c.onload=function(){var e=c.width,t=c.height,i=s.maxWidth,a=s.maxHeight,r=i&&i<e,o=a&&a<t;if(!(r||o))return l&&l(!1);r&&(e=i,t=Math.floor(c.height*e/c.width)),o&&(t=a,e=Math.floor(c.width*t/c.height));o=document.createElement("canvas"),a=o.getContext("2d");o.width=e,o.height=t,a.drawImage(c,0,0,e,t),l&&l(o.toDataURL(n),n)}}var g=".jpg,.png,.gif,.bmp,.webp,.tif,.tiff";c.support.imageScale=a,c.previewImage=n,c.scaleImage=u,c.UI.Image={init:function(){var e=this.ops,t=e.view;e.allows||(e.allows=g),t&&i(t,"ui-image "+(this.html5?"html5":"html4"))},supportScale:function(e){if(!a)return!1;var t=(this.ops.scale||{}).types||".jpg";return-1!=g.indexOf(e=".jpeg"==e?".jpg":e)&&("*"==t||-1!=t.indexOf(e))},previewImage:function(e,a,t){var r=this,i=a.scale||t.scale,o=i&&r.supportScale(a.ext);return o&&(a.skip=!0),n(e,a,function(e){r.fire("preview",{task:a,src:e}),e&&o&&u(e,"image/"+("jpg"==(e=(e=a.ext).slice(1))?"jpeg":e),i,function(e,t){var i;e&&(i=function(e,t){for(var e=e.split(","),i=atob(e[1]),a=[],r=0,o=i.length;r<o;r++)a[r]=i.charCodeAt(r);return s?new s([new Uint8Array(a)],{type:t}):((e=new d).append(a),e.getBlob(t))}(e,t),a.blob=i,r.fire("scale",{task:a,base64:e,type:t,blob:i})),a.skip=!1,r.list.push(a),r.auto&&r.start()})}),r},draw:function(e){var t,i,a,r,o,n,s,l,c,d=this,u=d.ops,g=u.view;g&&(c=e.name,t=e.id,(i=v("div","u-item",'<div class="u-img"></div><div class="u-progress-bar"><div class="u-progress"></div></div><div class="u-detail"></div><div class="u-name" title="'+c+'">'+c+'</div><div class="u-close-bg"></div><div class="u-close-text">X</div>')).taskId=t,a=f(i),r=p(a),o=f(r),n=p(r),s=p(n),l=p(s),c=p(l),m(r,.3),m(o,.5),m(l,.3),c.onclick=function(){g.removeChild(i),d.remove(t)},e.box=i,e.boxProgress=o,e.boxDetail=n,e.boxName=s,g.appendChild(i),d.previewImage(a,e,u).update(e))},update:function(e){var t,i,a,r,o,n,s;e&&e.box&&(t=e.total||e.size,i=e.loaded,a=e.state,r=e.boxProgress,o=e.boxDetail,n=c.getStatusText(a),this.html5&&i!=l&&0<=i&&(a==c.PROCESSING?"100.0"==(s=Math.min(100*i/t,100).toFixed(1))&&(s="99.9"):a==c.COMPLETE&&(s="100"),s&&(n+=" "+(s+="%"),r.style.width=s)),s=n,(n=o)&&(n.innerHTML=s||""),o.title=e.message||"")},over:function(e){e&&e.box&&i(e.box,"u-over")}},c.extend(c.UI.Image)}(window);